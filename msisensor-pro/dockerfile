# Use Ubuntu minimal base image for smaller size
FROM ubuntu:22.04

# Set environment variables to avoid interactive prompts
ENV DEBIAN_FRONTEND=noninteractive

# Install required dependencies and clean up in single layer to reduce image size
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        wget \
        ca-certificates \
        libbz2-1.0 \
        zlib1g \
        libncurses5 \
        libncursesw5 \
        libhts3 && \
    # Download msisensor-pro binary
    wget -O /usr/local/bin/msisensor-pro https://github.com/xjtu-omics/msisensor-pro/raw/master/binary/msisensor-pro && \
    chmod +x /usr/local/bin/msisensor-pro && \
    # Clean up to reduce image size
    apt-get remove -y wget ca-certificates && \
    apt-get autoremove -y && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*

# Set working directory
WORKDIR /data

# Add msisensor-pro to PATH (already in /usr/local/bin which is in PATH)
# Verify installation
RUN msisensor-pro --help || echo "msisensor-pro installed successfully"

# Default command
CMD ["msisensor-pro"]
